{"author": "Lukas Reiter", "plugins": [0, 6], "uuid": "7d0eb667-cca4-427a-8ca0-57d98c4177fd", "version": "v1.0", "script": "\"\"\"\nThis script extracts the values of the HTTP response headers, which are specified in variable \nsession[\"re_header_names\"] and displays them in the table above.\n\"\"\"\nimport re\n# Do the initial setup\nif ref == 1 or \"header_names\" not in session or \"case_sensitive\" not in session:\n\tsession[\"re_header_names\"] = [re.compile(\"^Server$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^X-Powered-By$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Content-Security-Policy$\",  re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^X-Frame-Options$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Strict-Transport-Security$\", re.IGNORECASE), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^X-XSS-Protection$\", re.IGNORECASE), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^X-Content-Type-Options$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Access-Control-Allow-Origin$\", re.IGNORECASE), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Access-Control-Allow-Methods$\", re.IGNORECASE), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Access-Control-Allow-Headers$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Access-Control-Expose-Headers$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Access-Control-Allow-Credentials$\", re.IGNORECASE), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Access-Control-Max-Age$\", re.IGNORECASE), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Origin$\", re.IGNORECASE), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Cache-control$\", re.IGNORECASE), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^Pragma$\", re.IGNORECASE)]\n\theader = [\"Ref.\", \"Host\", \"URL\", \"Extension\", \"Status Code\", \"Has Params\", \"Content-Type\"]\n\textension = url.getPath().split(\".\")[-1]\n\textension = extension if \"/\" not in extension else \"\"\n\tfor item in session[\"re_header_names\"]:\n\t\theader.append(item.pattern)\n# Process only in-scope HTTP responses\nresponse = message_info.getResponse()\nif in_scope and response:\n\tresponse_info = helpers.analyzeResponse(response)\n\trequest_info = analyze_request(message_info)\n\tcontent_type = get_content_type(response_info.getHeaders())\n\tresults = get_headers(response_info.getHeaders(), session[\"re_header_names\"])\n\tparameter_count = len(request_info.getParameters())\n\tcount = 0\n\trow = []\n\tfor key in session[\"re_header_names\"]:\n\t\tvalue = results[key.pattern]\n\t\tvalue = \";\".join(value) if value is not None else \"\"\n\t\tif value:\n\t\t\tcount = count +1\n\t\t\trow.append(value)\n\t\telse:\n\t\t\trow.append(\"\")\n\tif count > 0:\n\t\ttmp = [ref, url.getHost(), get_hostname(url), extension, response_info.getStatusCode(), parameter_count>0, content_type]\n\t\ttmp.extend(row)\n\t\trows.append(tmp)", "name": "Header - Template Script to Extract HTTP Response Header Values via Regular Expressions"}